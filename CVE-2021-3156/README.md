CVE-2021-3156 (conocida como Baron Samedit) es una vulnerabilidad crítica de desbordamiento de búfer basado en heap en la utilidad sudo, presente en la mayoría de sistemas Unix-like (Linux, macOS, BSD, etc.).Detalles principalesDescubierta por: Equipo de investigación de Qualys
Publicada: 26 de enero de 2021
Puntuación CVSS: 7.8 (Alta) — Ataque local, baja complejidad, sin privilegios requeridos, sin interacción del usuario
Impacto: Permite a cualquier usuario local sin privilegios (incluso si no está en el archivo sudoers) obtener acceso root en sistemas vulnerables con configuración por defecto.
Causa raíz: Un error off-by-one al procesar argumentos de línea de comandos que terminan en barra invertida (\), especialmente al usar sudoedit -s o sudo -s. Esto provoca un desbordamiento de búfer en el heap durante el escape/desescape de caracteres.

Versiones afectadasCasi todas las versiones de sudo desde mediados de 2011 hasta el parche:Rama legacy: 1.8.2 hasta 1.8.31p2
Rama estable: 1.9.0 hasta 1.9.5p1

Corregida en: sudo 1.9.5p2 (enero 2021) y versiones posteriores.En 2021 afectó a muchas distribuciones importantes (Ubuntu 20.04, Debian 10/11, Fedora, CentOS/RHEL, etc.), e incluso sistemas embebidos o legacy que no se actualizaron.

sudoedit -s /12345678901234567890\
